<div *ngIf="visible" class="character-selection-overlay">
  <div class="character-selection-modal">
    <h2>Manage Weapons</h2>
    <p *ngIf="!character">No character selected.</p>
    <div *ngIf="character">
      <p class="weapon-dialog-hint">
        Edit or add weapons for <strong>{{ character.name }}</strong>.  
        Press <strong>"Save Weapons"</strong> to apply your changes.
      </p>
      <table class="abilities-list">
        <thead>
          <tr>
            <th>Name</th>
            <th>AT-Mod</th>
            <th>PA-Mod</th>
            <th># Dice</th>
            <th>Damage Bonus</th>
            <th>Ini-Mod</th>
            <th>Combat Talent</th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let w of editableWeapons; let i = index">
            <td>
              <input type="text" [(ngModel)]="w.name" placeholder="Weapon name" title="Weapon name" />
            </td>
            <td>
              <input type="number" [(ngModel)]="w.atMod" placeholder="AT modifier" title="Attack modifier" />
            </td>
            <td>
              <input type="number" [(ngModel)]="w.paMod" placeholder="PA modifier" title="Parry modifier" />
            </td>
            <td>
              <input type="number" [(ngModel)]="w.numberOfDice" min="1" placeholder="# dice" title="Number of damage dice" />
            </td>
            <td>
              <input type="number" [(ngModel)]="w.damageBonus" placeholder="Bonus" title="Damage bonus" />
            </td>
            <td>
              <input type="number" [(ngModel)]="w.iniMod" placeholder="Ini" title="Initiative modifier" />
            </td>
            <td>
              <select 
                [(ngModel)]="w.combatTalent" 
                title="Combat talent"
                aria-label="Select combat talent for this weapon">
                <option [ngValue]="''">-- Select --</option>
                <option 
                  *ngFor="let ct of character.combatTalents || []" 
                  [ngValue]="ct.name">
                  {{ ct.name }} (AT {{ ct.attack }}, PA {{ ct.parry }})
                </option>
              </select>
            </td>
            <td>
              <button type="button" class="stat-btn-small" (click)="removeWeaponRow(i)">âœ•</button>
            </td>
          </tr>
        </tbody>
      </table>
      <div class="selection-actions">
        <button type="button" class="dice-btn" (click)="addWeaponRow()">Add Weapon</button>
        <button type="button" class="dice-btn stat-btn-apply" (click)="save()">Save Weapons</button>
        <button type="button" class="dice-btn" (click)="cancel()">Cancel</button>
      </div>
    </div>
  </div>
</div>


